<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel="alternate" type="text/html" href="/v/v1.11.0/docs/tasks/deployment/voms/_print/">
<meta name="robots" content="index, follow">


<link rel="shortcut icon" href="/v/v1.11.0/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/v/v1.11.0/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/v/v1.11.0/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/v/v1.11.0/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/v/v1.11.0/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/v/v1.11.0/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/v/v1.11.0/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/v/v1.11.0/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/v/v1.11.0/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/v/v1.11.0/favicons/android-192x192.png" sizes="192x192">

<title>Deploying the IAM VOMS attribute authority | INDIGO IAM</title>
<meta name="description" content="Instructions on how to deploy and configure the IAM VOMS attribute authority micro-service
">
<meta property="og:title" content="Deploying the IAM VOMS attribute authority" />
<meta property="og:description" content="Instructions on how to deploy and configure the IAM VOMS attribute authority micro-service
" />
<meta property="og:type" content="website" />
<meta property="og:url" content="/v/v1.11.0/docs/tasks/deployment/voms/" />

<meta itemprop="name" content="Deploying the IAM VOMS attribute authority">
<meta itemprop="description" content="Instructions on how to deploy and configure the IAM VOMS attribute authority micro-service
"><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Deploying the IAM VOMS attribute authority"/>
<meta name="twitter:description" content="Instructions on how to deploy and configure the IAM VOMS attribute authority micro-service
"/>




<link rel="preload" href="/v/v1.11.0/scss/main.min.8b15a284065632327b8c02a701e1c2297b5d1c084085e061cb33bbd46e6313e8.css" as="style">
<link href="/v/v1.11.0/scss/main.min.8b15a284065632327b8c02a701e1c2297b5d1c084085e061cb33bbd46e6313e8.css" rel="stylesheet" integrity="">

<script
  src="https://code.jquery.com/jquery-3.7.1.min.js"
  integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
  crossorigin="anonymous"></script>
<script defer
  src="https://unpkg.com/lunr@2.3.9/lunr.min.js"
  integrity="sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli"
  crossorigin="anonymous"></script>

  </head>
  <body class="td-section">
    <header>
      <nav class="td-navbar js-navbar-scroll" data-bs-theme="dark">
<div class="container-fluid flex-column flex-md-row">
  <a class="navbar-brand" href="/v/v1.11.0/"><span class="navbar-brand__logo navbar-logo"></span><span class="navbar-brand__name">INDIGO IAM</span></a>
  <div class="td-navbar-nav-scroll ms-md-auto" id="main_navbar">
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link active" href="/v/v1.11.0/docs/"><span>Documentation</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/v/v1.11.0/blog/"><span>Blog</span></a>
      </li>
      <li class="nav-item dropdown d-none d-lg-block">
        <div class="dropdown">
  <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Releases</a>
  <ul class="dropdown-menu">
    <li><a class="dropdown-item" href="https://indigo-iam.github.io/v/v1.11.0">v1.11.0</a></li>
    <li><a class="dropdown-item" href="https://indigo-iam.github.io/v/v1.10.2">v1.10.2</a></li>
    <li><a class="dropdown-item" href="https://indigo-iam.github.io/v/v1.10.1">v1.10.1</a></li>
    <li><a class="dropdown-item" href="https://indigo-iam.github.io/v/v1.10.0">v1.10.0</a></li>
    <li><a class="dropdown-item" href="https://indigo-iam.github.io/v/v1.9.0">v1.9.0</a></li>
    <li><a class="dropdown-item" href="https://indigo-iam.github.io/v/v1.8.4">v1.8.4</a></li>
    <li><a class="dropdown-item" href="https://indigo-iam.github.io/v/v1.8.3">v1.8.3</a></li>
    <li><a class="dropdown-item" href="https://indigo-iam.github.io/v/v1.8.2">v1.8.2</a></li>
    <li><a class="dropdown-item" href="https://indigo-iam.github.io/v/v1.8.1">v1.8.1</a></li>
    <li><a class="dropdown-item" href="https://indigo-iam.github.io/v/v1.8.0">v1.8.0</a></li>
    <li><a class="dropdown-item" href="https://indigo-iam.github.io/v/v1.7.2">v1.7.2</a></li>
    <li><a class="dropdown-item" href="https://indigo-iam.github.io/v/v1.7.1">v1.7.1</a></li>
    <li><a class="dropdown-item" href="https://indigo-iam.github.io/v/v1.7.0">v1.7.0</a></li>
    <li><a class="dropdown-item" href="https://indigo-iam.github.io/docs/v/current/">older releases</a></li>
    </ul>
</div></li>
      </ul>
  </div>
  <div class="d-none d-lg-block">
    <div class="td-search td-search--offline">
  <div class="td-search__icon"></div>
  <input
    type="search"
    class="td-search__input form-control"
    placeholder="Search this site…"
    aria-label="Search this site…"
    autocomplete="off"
    
    data-offline-search-index-json-src="/v/v1.11.0/offline-search-index.6584367da620fcc2292160969811b323.json"
    data-offline-search-base-href="/"
    data-offline-search-max-results="10"
  >
</div>
  </div>
</div>
</nav>
    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
            <div id="td-sidebar-menu" class="td-sidebar__inner">
  <div id="content-mobile">
  <form class="td-sidebar__search d-flex align-items-center">
    <div class="td-search td-search--offline">
  <div class="td-search__icon"></div>
  <input
    type="search"
    class="td-search__input form-control"
    placeholder="Search this site…"
    aria-label="Search this site…"
    autocomplete="off"
    
    data-offline-search-index-json-src="/v/v1.11.0/offline-search-index.6584367da620fcc2292160969811b323.json"
    data-offline-search-base-href="/"
    data-offline-search-max-results="10"
  >
</div>
    <button class="btn btn-link td-sidebar__toggle d-md-none p-0 ms-3 fas fa-bars" type="button" data-bs-toggle="collapse" data-bs-target="#td-section-nav" aria-controls="td-section-nav" aria-expanded="false" aria-label="Toggle section navigation">
    </button>
  </form>
  </div>
  <div id="content-desktop"></div>
  <nav class="td-sidebar-nav collapse td-sidebar-nav--search-disabled" id="td-section-nav">
    <ul class="td-sidebar-nav__section pe-md-3 ul-0">
      <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-vv1110docs-li">
  <a href="/v/v1.11.0/docs/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section tree-root" id="m-vv1110docs"><span class="">Documentation</span></a>
  <ul class="ul-1">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docsoverview-li">
  <a href="/v/v1.11.0/docs/overview/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docsoverview"><span class="">Overview</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-vv1110docsgetting-started-li">
  <a href="/v/v1.11.0/docs/getting-started/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docsgetting-started"><span class="">Getting Started</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docsgetting-startednginx-li">
  <a href="/v/v1.11.0/docs/getting-started/nginx/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docsgetting-startednginx"><span class="">NGINX configuration</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docsgetting-startedmariadb-li">
  <a href="/v/v1.11.0/docs/getting-started/mariadb/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docsgetting-startedmariadb"><span class="">Database configuration</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docsgetting-startedjwk-li">
  <a href="/v/v1.11.0/docs/getting-started/jwk/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docsgetting-startedjwk"><span class="">JSON Web Keys configuration</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docsgetting-starteddocker-li">
  <a href="/v/v1.11.0/docs/getting-started/docker/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docsgetting-starteddocker"><span class="">Deployment with Docker</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docsgetting-startedpackages-li">
  <a href="/v/v1.11.0/docs/getting-started/packages/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docsgetting-startedpackages"><span class="">Deployment with packages</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docsgetting-startedbasic_setup-li">
  <a href="/v/v1.11.0/docs/getting-started/basic_setup/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docsgetting-startedbasic_setup"><span class="">Basic IAM setup</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-vv1110docsreference-li">
  <a href="/v/v1.11.0/docs/reference/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docsreference"><span class="">Reference</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-vv1110docsreferenceapi-li">
  <a href="/v/v1.11.0/docs/reference/api/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docsreferenceapi"><span class="">APIs</span></a>
  <ul class="ul-3 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docsreferenceapiaup-api-li">
  <a href="/v/v1.11.0/docs/reference/api/aup-api/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docsreferenceapiaup-api"><span class="">AUP management API</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docsreferenceapiaup-sign-api-li">
  <a href="/v/v1.11.0/docs/reference/api/aup-sign-api/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docsreferenceapiaup-sign-api"><span class="">AUP signature API</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docsreferenceapiproxycert-api-li">
  <a href="/v/v1.11.0/docs/reference/api/proxycert-api/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docsreferenceapiproxycert-api"><span class="">Proxy certificate API</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docsreferenceapigroup-requests-li">
  <a href="/v/v1.11.0/docs/reference/api/group-requests/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docsreferenceapigroup-requests"><span class="">Group requests API</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docsreferenceapihealth_endpoints-li">
  <a href="/v/v1.11.0/docs/reference/api/health_endpoints/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docsreferenceapihealth_endpoints"><span class="">Health checks</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docsreferenceapiaccount-api-li">
  <a href="/v/v1.11.0/docs/reference/api/account-api/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docsreferenceapiaccount-api"><span class="">IAM account API</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docsreferenceapitokens-api-li">
  <a href="/v/v1.11.0/docs/reference/api/tokens-api/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docsreferenceapitokens-api"><span class="">IAM Token management API</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docsreferenceapioauth-token-exchange-li">
  <a href="/v/v1.11.0/docs/reference/api/oauth-token-exchange/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docsreferenceapioauth-token-exchange"><span class="">OAuth token exchange API</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docsreferenceapioauth-token-introspection-li">
  <a href="/v/v1.11.0/docs/reference/api/oauth-token-introspection/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docsreferenceapioauth-token-introspection"><span class="">OAuth token introspection API</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docsreferenceapioidc-client-management-li">
  <a href="/v/v1.11.0/docs/reference/api/oidc-client-management/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docsreferenceapioidc-client-management"><span class="">OpenID Connect client management API</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docsreferenceapioidc-client-registration-li">
  <a href="/v/v1.11.0/docs/reference/api/oidc-client-registration/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docsreferenceapioidc-client-registration"><span class="">OpenID Connect client registration API</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docsreferenceapiscim-api-li">
  <a href="/v/v1.11.0/docs/reference/api/scim-api/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docsreferenceapiscim-api"><span class="">SCIM API</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docsreferenceapiscope-policy-api-li">
  <a href="/v/v1.11.0/docs/reference/api/scope-policy-api/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docsreferenceapiscope-policy-api"><span class="">Scope Policy API</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docsreferenceapistats-endpoint-li">
  <a href="/v/v1.11.0/docs/reference/api/stats-endpoint/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docsreferenceapistats-endpoint"><span class="">Statistical endpoint</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docsreferenceapitoken-exchange-policy-api-li">
  <a href="/v/v1.11.0/docs/reference/api/token-exchange-policy-api/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docsreferenceapitoken-exchange-policy-api"><span class="">Token exchange policy API</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-vv1110docsreferenceconfiguration-li">
  <a href="/v/v1.11.0/docs/reference/configuration/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docsreferenceconfiguration"><span class="">Configuration</span></a>
  <ul class="ul-3 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docsreferenceconfigurationjwt-profiles-li">
  <a href="/v/v1.11.0/docs/reference/configuration/jwt-profiles/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docsreferenceconfigurationjwt-profiles"><span class="">JWT profiles support</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docsreferenceconfigurationmulti-factor-authn-li">
  <a href="/v/v1.11.0/docs/reference/configuration/multi-factor-authn/" title="Multi-Factor Authentication (MFA)" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docsreferenceconfigurationmulti-factor-authn"><span class="">Multi-factor authentication</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docsreferenceconfigurationsystem-scopes-li">
  <a href="/v/v1.11.0/docs/reference/configuration/system-scopes/" title="MitreID System Scopes" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docsreferenceconfigurationsystem-scopes"><span class="">System scopes</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docsreferenceconfigurationlifecycle-li">
  <a href="/v/v1.11.0/docs/reference/configuration/lifecycle/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docsreferenceconfigurationlifecycle"><span class="">Membership lifecycle</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docsreferenceconfigurationrcauth-li">
  <a href="/v/v1.11.0/docs/reference/configuration/rcauth/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docsreferenceconfigurationrcauth"><span class="">Integration with RCAuth</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docsreferenceconfigurationregistration-li">
  <a href="/v/v1.11.0/docs/reference/configuration/registration/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docsreferenceconfigurationregistration"><span class="">Registration &amp; Enrollment</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docsreferenceconfigurationscim-response-li">
  <a href="/v/v1.11.0/docs/reference/configuration/scim-response/" title="Handling SCIM response" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docsreferenceconfigurationscim-response"><span class="">SCIM response</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docsreferenceconfigurationclient-registration-li">
  <a href="/v/v1.11.0/docs/reference/configuration/client-registration/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docsreferenceconfigurationclient-registration"><span class="">Client registration</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docsreferenceconfigurationjwk-li">
  <a href="/v/v1.11.0/docs/reference/configuration/jwk/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docsreferenceconfigurationjwk"><span class="">JSON Web Keys (JWK)</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docsreferenceconfigurationlocal_authn-li">
  <a href="/v/v1.11.0/docs/reference/configuration/local_authn/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docsreferenceconfigurationlocal_authn"><span class="">Local authentication</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-vv1110docsreferenceconfigurationexternal-authentication-li">
  <a href="/v/v1.11.0/docs/reference/configuration/external-authentication/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docsreferenceconfigurationexternal-authentication"><span class="">External authentication</span></a>
  <ul class="ul-4 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docsreferenceconfigurationexternal-authenticationoidc-li">
  <a href="/v/v1.11.0/docs/reference/configuration/external-authentication/oidc/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docsreferenceconfigurationexternal-authenticationoidc"><span class="">OpenID-Connect authentication</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docsreferenceconfigurationexternal-authenticationsaml-li">
  <a href="/v/v1.11.0/docs/reference/configuration/external-authentication/saml/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docsreferenceconfigurationexternal-authenticationsaml"><span class="">SAML authentication</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docsreferenceconfigurationexternal-authenticationx509-li">
  <a href="/v/v1.11.0/docs/reference/configuration/external-authentication/x509/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docsreferenceconfigurationexternal-authenticationx509"><span class="">X.509 authentication</span></a>
</li>
  </ul>
</li>
  </ul>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-vv1110docstasks-li">
  <a href="/v/v1.11.0/docs/tasks/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docstasks"><span class="">Tasks</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-vv1110docstasksadministration-li">
  <a href="/v/v1.11.0/docs/tasks/administration/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docstasksadministration"><span class="">IAM organization administration</span></a>
  <ul class="ul-3 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docstasksadministrationuser-management-li">
  <a href="/v/v1.11.0/docs/tasks/administration/user-management/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docstasksadministrationuser-management"><span class="">User management</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docstasksadministrationclient-status-change-li">
  <a href="/v/v1.11.0/docs/tasks/administration/client-status-change/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docstasksadministrationclient-status-change"><span class="">Disable or Enable a client</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docstasksadministrationgroup-management-li">
  <a href="/v/v1.11.0/docs/tasks/administration/group-management/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docstasksadministrationgroup-management"><span class="">Group Management</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docstasksadministrationaup-management-li">
  <a href="/v/v1.11.0/docs/tasks/administration/aup-management/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docstasksadministrationaup-management"><span class="">Acceptable Usage Policy (AUP) management</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-vv1110docstasksdeployment-li">
  <a href="/v/v1.11.0/docs/tasks/deployment/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docstasksdeployment"><span class="">IAM service deployment</span></a>
  <ul class="ul-3 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docstasksdeploymentbackup_restore-li">
  <a href="/v/v1.11.0/docs/tasks/deployment/backup_restore/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docstasksdeploymentbackup_restore"><span class="">Backup &amp; Restore</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docstasksdeploymentaudit-log-li">
  <a href="/v/v1.11.0/docs/tasks/deployment/audit-log/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docstasksdeploymentaudit-log"><span class="">Audit log</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docstasksdeploymentupgrade-li">
  <a href="/v/v1.11.0/docs/tasks/deployment/upgrade/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docstasksdeploymentupgrade"><span class="">Upgrade</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docstasksdeploymentha-li">
  <a href="/v/v1.11.0/docs/tasks/deployment/ha/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docstasksdeploymentha"><span class="">Deploying IAM in HA</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id="m-vv1110docstasksdeploymentvoms-li">
  <a href="/v/v1.11.0/docs/tasks/deployment/voms/" class="align-left ps-0 active td-sidebar-link td-sidebar-link__section" id="m-vv1110docstasksdeploymentvoms"><span class="td-sidebar-nav-active-item">Deploying the IAM VOMS attribute authority</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docstasksdeploymentvoms_importer-li">
  <a href="/v/v1.11.0/docs/tasks/deployment/voms_importer/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docstasksdeploymentvoms_importer"><span class="">Importing VOMS information into IAM</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docstasksclientapp-li">
  <a href="/v/v1.11.0/docs/tasks/clientapp/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docstasksclientapp"><span class="">IAM Test Client application</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-vv1110docstasksuser-li">
  <a href="/v/v1.11.0/docs/tasks/user/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docstasksuser"><span class="">User</span></a>
  <ul class="ul-3 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docstasksuserjoining-a-collaboration-li">
  <a href="/v/v1.11.0/docs/tasks/user/joining-a-collaboration/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docstasksuserjoining-a-collaboration"><span class="">Joining an IAM-managed organization</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docstasksusergetting-a-token-li">
  <a href="/v/v1.11.0/docs/tasks/user/getting-a-token/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docstasksusergetting-a-token"><span class="">Obtaining an IAM access token from a CLI</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docstasksuserresign-aup-li">
  <a href="/v/v1.11.0/docs/tasks/user/resign-aup/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docstasksuserresign-aup"><span class="">Re-sign AUP</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docstasksuserclient-registration-li">
  <a href="/v/v1.11.0/docs/tasks/user/client-registration/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docstasksuserclient-registration"><span class="">Registering a client</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docstasksuserchange-details-li">
  <a href="/v/v1.11.0/docs/tasks/user/change-details/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docstasksuserchange-details"><span class="">Change account information</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docstasksuserchange-password-li">
  <a href="/v/v1.11.0/docs/tasks/user/change-password/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docstasksuserchange-password"><span class="">Changing the account password</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docstasksuserjwt-authn-li">
  <a href="/v/v1.11.0/docs/tasks/user/jwt-authn/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docstasksuserjwt-authn"><span class="">JWT client authentication</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docstasksuserexternal-account-linking-li">
  <a href="/v/v1.11.0/docs/tasks/user/external-account-linking/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docstasksuserexternal-account-linking"><span class="">Linking an external account</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docstasksuserx509-linking-li">
  <a href="/v/v1.11.0/docs/tasks/user/x509-linking/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docstasksuserx509-linking"><span class="">Linking an X.509 certificate</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docstasksusermanage-active-tokens-li">
  <a href="/v/v1.11.0/docs/tasks/user/manage-active-tokens/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docstasksusermanage-active-tokens"><span class="">Managing active tokens</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docstasksusermanage-approved-sites-li">
  <a href="/v/v1.11.0/docs/tasks/user/manage-approved-sites/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docstasksusermanage-approved-sites"><span class="">Managing approved sites</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docstasksusermanage-ssh-keys-li">
  <a href="/v/v1.11.0/docs/tasks/user/manage-ssh-keys/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docstasksusermanage-ssh-keys"><span class="">Managing SSH keys</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docstasksuserreset-password-li">
  <a href="/v/v1.11.0/docs/tasks/user/reset-password/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docstasksuserreset-password"><span class="">Reset an account password</span></a>
</li>
  </ul>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-vv1110docsdeveloper-guide-li">
  <a href="/v/v1.11.0/docs/developer-guide/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docsdeveloper-guide"><span class="">Developer guide</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-vv1110docsdeveloper-guidespecs-li">
  <a href="/v/v1.11.0/docs/developer-guide/specs/" title="Specifications and useful resources" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-vv1110docsdeveloper-guidespecs"><span class="">Specifications</span></a>
</li>
  </ul>
</li>
  </ul>
</li>
    </ul>
  </nav>
</div>

          </aside>
          <aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none">
            <div class="td-page-meta ms-2 pb-1 pt-2 mb-0">
<a href="https://github.com/indigo-iam/iam-website/tree/v1.11.0/content/en/docs/tasks/deployment/voms/_index.md" class="td-page-meta--view td-page-meta__view" target="_blank" rel="noopener"><i class="fa-solid fa-file-lines fa-fw"></i> View page source</a>
  <a href="https://github.com/indigo-iam/iam-website/edit/v1.11.0/content/en/docs/tasks/deployment/voms/_index.md" class="td-page-meta--edit td-page-meta__edit" target="_blank" rel="noopener"><i class="fa-solid fa-pen-to-square fa-fw"></i> Edit this page</a>
  <a href="https://github.com/indigo-iam/iam-website/new/v1.11.0/content/en/docs/tasks/deployment/voms?filename=change-me.md&amp;value=---%0Atitle%3A&#43;%22Long&#43;Page&#43;Title%22%0AlinkTitle%3A&#43;%22Short&#43;Nav&#43;Title%22%0Aweight%3A&#43;100%0Adescription%3A&#43;%3E-%0A&#43;&#43;&#43;&#43;&#43;Page&#43;description&#43;for&#43;heading&#43;and&#43;indexes.%0A---%0A%0A%23%23&#43;Heading%0A%0AEdit&#43;this&#43;template&#43;to&#43;create&#43;your&#43;new&#43;page.%0A%0A%2A&#43;Give&#43;it&#43;a&#43;good&#43;name%2C&#43;ending&#43;in&#43;%60.md%60&#43;-&#43;e.g.&#43;%60getting-started.md%60%0A%2A&#43;Edit&#43;the&#43;%22front&#43;matter%22&#43;section&#43;at&#43;the&#43;top&#43;of&#43;the&#43;page&#43;%28weight&#43;controls&#43;how&#43;its&#43;ordered&#43;amongst&#43;other&#43;pages&#43;in&#43;the&#43;same&#43;directory%3B&#43;lowest&#43;number&#43;first%29.%0A%2A&#43;Add&#43;a&#43;good&#43;commit&#43;message&#43;at&#43;the&#43;bottom&#43;of&#43;the&#43;page&#43;%28%3C80&#43;characters%3B&#43;use&#43;the&#43;extended&#43;description&#43;field&#43;for&#43;more&#43;detail%29.%0A%2A&#43;Create&#43;a&#43;new&#43;branch&#43;so&#43;you&#43;can&#43;preview&#43;your&#43;new&#43;file&#43;and&#43;request&#43;a&#43;review&#43;via&#43;Pull&#43;Request.%0A" class="td-page-meta--child td-page-meta__child" target="_blank" rel="noopener"><i class="fa-solid fa-pen-to-square fa-fw"></i> Create child page</a>
  <a href="https://github.com/indigo-iam/iam-website/issues/new?title=Deploying%20the%20IAM%20VOMS%20attribute%20authority" class="td-page-meta--issue td-page-meta__issue" target="_blank" rel="noopener"><i class="fa-solid fa-list-check fa-fw"></i> Create documentation issue</a>
  <a href="https://github.com/indigo-iam/iam/issues/new" class="td-page-meta--project td-page-meta__project-issue" target="_blank" rel="noopener"><i class="fa-solid fa-list-check fa-fw"></i> Create project issue</a>
  <a id="print" href="/v/v1.11.0/docs/tasks/deployment/voms/_print/"><i class="fa-solid fa-print fa-fw"></i> Print entire section</a>

</div>

            <div class="td-toc">
        <nav id="TableOfContents">
  <ul>
    <li><a href="#the-iam-voms-attribute-authority">The IAM VOMS attribute authority</a>
      <ul>
        <li><a href="#deployment-architecture">Deployment architecture</a></li>
        <li><a href="#nginx-voms-module-configuration">NGINX VOMS module configuration</a></li>
        <li><a href="#configuration-of-egi-trust-anchors-and-voms-aa-certificate">Configuration of EGI trust anchors and VOMS AA certificate</a></li>
        <li><a href="#podmandocker-compose-example">Podman/Docker Compose example</a></li>
      </ul>
    </li>
  </ul>
</nav>
      </div>
    
            

          </aside>
          <main class="col-12 col-md-9 col-xl-8 ps-md-5" role="main">
            
  

            <nav aria-label="breadcrumb" class="td-breadcrumbs">
  <ol class="breadcrumb">
  <li class="breadcrumb-item">
    <a href="/v/v1.11.0/docs/">Documentation</a></li>
  <li class="breadcrumb-item">
    <a href="/v/v1.11.0/docs/tasks/">Tasks</a></li>
  <li class="breadcrumb-item">
    <a href="/v/v1.11.0/docs/tasks/deployment/">IAM service deployment</a></li>
  <li class="breadcrumb-item active" aria-current="page">
    Deploying the IAM VOMS attribute authority</li>
  </ol>
</nav>
            
<div class="td-content">
	<h1>Deploying the IAM VOMS attribute authority</h1>
  <div class="lead">Instructions on how to deploy and configure the IAM VOMS attribute authority micro-service</div>
	<header class="article-meta">
		
</header>
	<h2 id="the-iam-voms-attribute-authority">The IAM VOMS attribute authority</h2>
<p>The IAM <a href="https://github.com/indigo-iam/iam/tree/master/iam-voms-aa">VOMS attribute authority</a> (AA) provide a backward-compatible
<a href="http://italiangrid.github.io/voms/">VOMS</a> support for a Virtual Organization managed with IAM.</p>
<h3 id="deployment-architecture">Deployment architecture</h3>
<p><img src="../img/iam-voms-aa.png" alt="VOMS AA deployment"></p>
<p>The VOMS attribute authority can access the IAM database and encode IAM groups
and other attributes in a standard VOMS attribute certificate. This means in
practice that IAM can act both as an OAuth/OpenID Connect authorization server
and as a VOMS server for a given organization. TLS termination and client VOMS
atttribute certificate parsing and validation is delegated to an <a href="https://baltig.infn.it/cnafsd/ngx_http_voms_module">NGINX VOMS module</a>,
which can de deployed as a sidecar service that just protects the
VOMS AA or also in front of the IAM backend application. The two scenarios are
depicted above.</p>
<p>In order to deploy a VOMS attribute authority, you are recommended to use the following
docker images:</p>
<ul>
<li><code>cnafsd/nginx-httpg-voms</code>, for a NGINX server configured with the <a href="https://baltig.infn.it/cnafsd/ngx_http_voms_module">VOMS module</a>,
which replaces <a href="https://baltig.infn.it/cnafsd/ngx_http_voms_module">OpenResty VOMS</a></li>
<li><code>indigoiam/voms-aa-bp:v1.11.0</code>, for the VOMS AA service</li>
</ul>
<p>Deployment from packages is not currently supported for the VOMS attribute
authority.</p>
<h3 id="nginx-voms-module-configuration">NGINX VOMS module configuration</h3>
<p>The NGINX VOMS module requires:</p>
<ul>
<li>the IGTF trust anchors properly configured; see the <a href="https://github.com/indigo-iam/egi-trust-anchors-container/">EGI trust anchors</a>
container.</li>
<li>The certificate and private key to use: the certificate issuer must be one of
the CA present in the EGI trust anchors. See the specific section below.</li>
<li>the <code>vomsdir</code> folder, with the VOMS LSC configuration generated starting from
the VOMS attribute authority X.509 credential.</li>
</ul>
<p>To generate the LSC configuration, you need to get the subject and issuer of the
VOMS AA X.509 credential and put them in a file named as the fully qualified
domain name of the VOMS attribute authority with the <code>.lsc</code> extension.</p>
<p>Let&rsquo;s assume that the IAM VOMS AA will answer on <code>voms.test.example</code> for the VO
<code>example.vo</code>.  The following command will generate the appropriate LSC file
(<code>X509_VOMS_DIR</code> can be set to any directory where you have writing privileges):</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span><span style="color:#8f5902">&gt;</span> mkdir -p <span style="color:#4e9a06">${</span><span style="color:#000">X509_VOMS_DIR</span><span style="color:#4e9a06">}</span>/example.vo
</span></span><span style="display:flex;"><span><span style="color:#8f5902">&gt;</span> openssl x509 -in voms_local_io.cert.pem -noout -subject -issuer -nameopt compat <span style="color:#000;font-weight:bold">|</span> <span style="color:#4e9a06">\
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06"></span><span style="color:#000;font-style:italic">  gsed -e &#39;s/^subject=//&#39; -e &#39;s/^issuer=//&#39; &gt; \
</span></span></span><span style="display:flex;"><span><span style="color:#000;font-style:italic">  ${X509_VOMS_DIR}/example.vo/voms.test.example.lsc
</span></span></span></code></pre></div><p>For an example NGINX configuration, see the one use in <a href="https://github.com/indigo-iam/iam/blob/master/compose/voms-deploy/assets/nginx/conf.d/voms.test.example.conf">VOMS-enabled NGINX container</a>.</p>
<h4 id="voms-aa-configuration">VOMS AA configuration</h4>
<p>The VOMS AA is a Spring Boot application that shares the persistence
layer implementation with IAM, and as such can inspect the IAM database. It can share
the same environment file as the login service it is associated with, with the addition of the
following variables:</p>
<ul>
<li><code>VOMS_AA_HOST</code>: host name used to access the VOMS AA service</li>
<li><code>VOMS_AA_PORT</code> VOMS AA port</li>
<li><code>VOMS_AA_VO</code>: VO served by the VOMS AA service</li>
</ul>
<p>You also need to create a VOMS AA YAML configuration file with the content below (its content should
be generic as it relies on standard environment variables used to configure the login service) and map it
to the container as <code>/workspace/config/application.yml</code>.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">server</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">address</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">0.0.0.0</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">8080</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">use-forward-headers</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">max-http-header-size</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">16000</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">spring</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">main</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">banner-mode</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;off&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">jpa</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">open-in-view</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">datasource</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">dataSourceClassName</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">com.mysql.jdbc.jdbc2.optional.MysqlDataSource</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">url</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">jdbc:mysql://${IAM_DB_HOST}:${IAM_DB_PORT:3306}/${IAM_DB_NAME}?useLegacyDatetimeCode=false&amp;serverTimezone=UTC&amp;useSSL=false</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">username</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">${IAM_DB_USERNAME}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">password</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">${IAM_DB_PASSWORD}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">max-active</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">${IAM_DB_MAX_ACTIVE:10}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">max-idle</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">${IAM_DB_MAX_IDLE:5}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">initial-size</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">${IAM_DB_INITIAL_SIZE:1}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">test-while-idle</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">${IAM_DB_TEST_WHILE_IDLE:true}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">test-on-borrow</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">${IAM_DB_TEST_ON_BORROW:true}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">validation-query</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">${IAM_DB_VALIDATION_QUERY:SELECT 1}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">time-between-eviction-runs-millis</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">${IAM_DB_TIME_BETWEEN_EVICTION_RUNS_MILLIS:5000}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">min-evictable-idle-time-millis</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">${IAM_DB_MIN_EVICTABLE_IDLE_TIME_MILLIS:60000}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">flyway</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">enabled</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">voms</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">tls</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">certificate-path</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/certs/hostcert.pem</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">private-key-path</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/certs/hostkey.pem</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">trust-anchors-dir</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/etc/grid-security/certificates</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">trust-anchors-refresh-interval-secs</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">14400</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">aa</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">host</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">${VOMS_AA_HOST:undefined}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">port</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">${VOMS_AA_PORT:undefined}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">vo-name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">${VOMS_AA_VO:undefined}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">use-legacy-fqan-encoding</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">${VOMS_AA_USE_LEGACY_FQAN_ENCODING:true}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>To map this file (in the example below, <code>voms-aa.yml</code>as <code>/workspace/config/application.yml</code>), you
typically need to add the following volume definition to the VOMS AA section of your Podman/Docker
compose file:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">volumes</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">            </span>- <span style="color:#000">/path/to/voms-aa.yml:/workspace/config/application.yml:ro,Z</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p><em>Note: <code>Z</code> at the end of the line is required only if you use SELinux</em></p>
<p>In addition, you need to configure the EGI trust anchors and the VOMS AA certificate and
private key, as described below.</p>
<h3 id="configuration-of-egi-trust-anchors-and-voms-aa-certificate">Configuration of EGI trust anchors and VOMS AA certificate</h3>
<p>Both the VOMS-enabled NGINX service and the VOMS AA service require the proper configuration
of the container, the certificate and private key to use and the EGI trust anchors. If using
Podman/Docker Compose, it is typically done with:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">volumes</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">            </span>- <span style="color:#000">/path/to/certs/voms.test.example.cert.pem:/certs/hostcert.pem:ro,Z</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">            </span>- <span style="color:#000">/path/to/certs/voms.test.example.cert.key:/certs/hostkey.pem:ro,Z</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex;"><span><span style="color:#f8f8f8;text-decoration:underline">            </span>- <span style="color:#000">/etc/grid-security/certificates:/etc/grid-security/certificates:ro,Z</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>The line to map EGI trust anchor may be different if you use <a href="https://github.com/indigo-iam/egi-trust-anchors-container/">EGI trust anchors</a>
container. See the Podman/Docker Compose example for more information.</p>
<p>Note that the private key must be readable by the user running the service. As it is not a good
practice to make it world readable, it may be necessary to adjust its ownership.</p>
<h3 id="podmandocker-compose-example">Podman/Docker Compose example</h3>
<p>For an example of the container configurations, see the <a href="https://github.com/indigo-iam/iam/blob/master/compose/voms-deploy/docker-compose.yml">VOMS AA Docker compose
file</a>.</p>

  <div class="section-index">
    
    
    </div>
<div class="td-page-meta__lastmod">
  Last modified February 6, 2025: <a href="https://github.com/indigo-iam/iam-website/commit/3062b440b82dd16d921c6c8d640cf7df7fa7d913">Fix typo in VOMS AA documentation (#141) (3062b44)</a>
</div>
</div>

          </main>
        </div>
      </div>
      <footer class="td-footer row d-print-none">
  <div class="container-fluid">
    <div class="row mx-md-2">
      <div class="td-footer__left col-6 col-sm-4 order-sm-1">
        
      </div><div class="td-footer__right col-6 col-sm-4 order-sm-3">
        <ul class="td-footer__links-list">
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="GitHub" aria-label="GitHub">
    <a target="_blank" rel="noopener" href="https://github.com/indigo-iam/iam" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Slack" aria-label="Slack">
    <a target="_blank" rel="noopener" href="https://indigo-iam.slack.com" aria-label="Slack">
      <i class="fab fa-slack"></i>
    </a>
  </li>
  
</ul>

      </div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2">
        <span class="td-footer__copyright">&copy;
    2025
    <span class="td-footer__authors">INFN</span></span><span class="td-footer__all_rights_reserved">All Rights Reserved</span>
      </div>
    </div>
  </div>
</footer>

    </div>
    <script src="/v/v1.11.0/js/main.min.dc2c0119076a0df855e55a8044ce0de74b7b9033c20e853e22d7ec7e9bdde965.js" integrity="sha256-3CwBGQdqDfhV5VqARM4N50t7kDPCDoU&#43;Itfsfpvd6WU=" crossorigin="anonymous"></script>
<script defer src="/v/v1.11.0/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js" integrity="sha256-c0eKfUgHaYrtfjVesj&#43;YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin="anonymous"></script>
<script src='/v/v1.11.0/js/tabpane-persist.js'></script>

  </body>
</html>