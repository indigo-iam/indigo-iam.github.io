<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.86.0" /><link rel="canonical" type="text/html" href="/v/v1.8.1/docs/getting-started/docker/">
<META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">


<link rel="shortcut icon" href="/v/v1.8.1/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/v/v1.8.1/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/v/v1.8.1/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/v/v1.8.1/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/v/v1.8.1/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/v/v1.8.1/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/v/v1.8.1/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/v/v1.8.1/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/v/v1.8.1/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/v/v1.8.1/favicons/android-192x192.png" sizes="192x192">

<title>Deployment with Docker | INDIGO IAM</title><meta property="og:title" content="Deployment with Docker" />
<meta property="og:description" content="The INDIGO Identity and Access Management (IAM) Service" />
<meta property="og:type" content="website" />
<meta property="og:url" content="/v/v1.8.1/docs/getting-started/docker/" /><meta property="og:site_name" content="INDIGO IAM" />

<meta itemprop="name" content="Deployment with Docker">
<meta itemprop="description" content="The INDIGO Identity and Access Management (IAM) Service"><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Deployment with Docker"/>
<meta name="twitter:description" content="The INDIGO Identity and Access Management (IAM) Service"/>







<link rel="preload" href="/v/v1.8.1/scss/main.min.8c56a5db29a8a7bfd7c31c587d450fd15c23c45c8cd6e72142c8ed5b2ef43bd5.css" as="style">
<link href="/v/v1.8.1/scss/main.min.8c56a5db29a8a7bfd7c31c587d450fd15c23c45c8cd6e72142c8ed5b2ef43bd5.css" rel="stylesheet" integrity="">


<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>

<script
  src="https://unpkg.com/lunr@2.3.8/lunr.min.js"
  integrity="sha384-vRQ9bDyE0Wnu+lMfm57BlYLO0/XauFuKpVsZPs7KEDwYKktWi5+Kz3MP8++DFlRY"
  crossorigin="anonymous"></script>




  </head>
  <body class="td-section">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
        <a class="navbar-brand" href="/v/v1.8.1/">
		<span class="navbar-logo"></span><span class="text-uppercase font-weight-bold">INDIGO IAM</span>
	</a>
	<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
		<ul class="navbar-nav mt-2 mt-lg-0">
			
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a  class="nav-link active" href="/v/v1.8.1/docs/" ><span class="active">Documentation</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a  class="nav-link" href="/v/v1.8.1/blog/" ><span>Blog</span></a>
			</li>
			
			
			<li class="nav-item dropdown d-none d-lg-block">
				<a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
	Releases
</a>
<div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
	
	<a class="dropdown-item" href="https://indigo-iam.github.io/v/current">v1.8.1</a>
	
	<a class="dropdown-item" href="https://indigo-iam.github.io/v/v1.8.0">v1.8.0</a>
	
	<a class="dropdown-item" href="https://indigo-iam.github.io/v/v1.7.2">v1.7.2</a>
	
	<a class="dropdown-item" href="https://indigo-iam.github.io/v/v1.7.1">v1.7.1</a>
	
	<a class="dropdown-item" href="https://indigo-iam.github.io/v/v1.7.0">v1.7.0</a>
	
	<a class="dropdown-item" href="https://indigo-iam.github.io/docs/v/current/">older releases</a>
	
</div>

			</li>
			
			
		</ul>
	</div>
	<div class="navbar-nav d-none d-lg-block">



<input
  type="search"
  class="form-control td-search-input"
  placeholder="&#xf002; Search this site…"
  aria-label="Search this site…"
  autocomplete="off"
  
  data-offline-search-index-json-src="/v/v1.8.1/offline-search-index.8bef3e1645fda0ab5a686eb3576d6e28.json"
  data-offline-search-base-href="/"
  data-offline-search-max-results="10"
>

</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
          </div>
          <div class="d-none d-xl-block col-xl-2 td-toc d-print-none">
          </div>
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This the multi-page printable view of this section.
<a href="#" onclick="print();return false;">Click here to print</a>.
</p><p>
<a href="/v/v1.8.1/docs/getting-started/docker/">Return to the regular view of this page</a>.
</p>
</div>



<h1 class="title">Deployment with Docker</h1>





    <ul>
    
  
  
  
  

  

    </ul>


<div class="content">
      <p>The IAM service is provided on the following DockerHub repositories:</p>
<ul>
<li><a href="https://hub.docker.com/r/indigoiam/iam-login-service/">indigoiam/iam-login-service</a></li>
</ul>
<p>The docker image tag corresponding to this version of the documentation is:</p>


<div class="pageinfo pageinfo-primary">
<p>indigoiam/iam-login-service:v1.8.1</p>

</div>

<p>The IAM image has been tested to run properly with either Docker or Podman. The configuration for the
IAM service container is the same but the details to run the container slightly differ. Differences
are covered in the next sections. In both cases, it is <strong>highly</strong> recommended to enable SELinux for
increased security.</p>
<h2 id="configuring-the-iam-service">Configuring the IAM service</h2>
<p>Prepare an environment file that will contain the environment variables
settings for the IAM service container. See <a href="/v/v1.8.1/docs/reference/configuration/">the configuration
reference</a> for a description of the variables.</p>
<p>This environment file will be passed to the container with the <code>--env-file</code> option of the
container engine. You can choose whatever file path/name you want.</p>
<h2 id="running-the-container">Running the container</h2>
<h3 id="docker">Docker</h3>
<p>First create a Docker network for the IAM service with the command (the example uses
the network name <code>iam</code> but you are free to use another name as long as you use the same
one in the <code>run</code>command). It has to be done once (not at every restart of the container):</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ docker network create iam
</code></pre></div><p>When using Docker the IAM service is run starting container with the following command:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ docker run -d <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  --name iam-login-service <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  --net<span style="color:#ce5c00;font-weight:bold">=</span>iam -p 8080:8080 <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  --env-file<span style="color:#ce5c00;font-weight:bold">=</span>/path/to/iam-login-service/env <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  -v /path/to/keystore.jks:/keystore.jks:ro <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  --restart unless-stopped <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  indigoiam/iam-login-service:v1.8.1
</code></pre></div><p><em>Note: <code>--restart</code> is recommended if you want the IAM service to restart automatically
when the server running Docker is restarted.</em></p>
<p>Check the logs with:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#8f5902;font-style:italic"># Adapt the container name to the value you provided to --name in previous command</span>
$ docker logs -f iam-login-service
</code></pre></div><h3 id="podman">Podman</h3>
<p>When using Podman, the <code>docker</code> command must be replaced by <code>podman</code> with the following
differences in options:</p>
<ul>
<li>
<p><code>--restart</code> is silently ignored as start/stop of the container at boot time is controlled
with <code>systemd</code> (see Podman documentation, <a href="https://docs.podman.io/en/latest/markdown/podman-generate-systemd.1.html">here</a>).</p>
</li>
<li>
<p>You need to add option <code>Z</code> to third field of <code>-v</code> option so that the SELinux context
type is properly managed and the use of the volume by another container is prevented.</p>
</li>
<li>
<p>Ensure that the directories containing the environment file and the keystore are
labeled. It can be checked with <code>stat</code> command. If they are unlabeled use the following
command to fix it:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ chcon -R -t default_t /path/to/directory
</code></pre></div></li>
</ul>
<p>The required commands to start the container then become:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ podman network create iam      <span style="color:#8f5902;font-style:italic"># First time only</span>
$ podman run -d <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  --name iam-login-service <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  --net<span style="color:#ce5c00;font-weight:bold">=</span>iam -p 8080:8080 <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  --env-file<span style="color:#ce5c00;font-weight:bold">=</span>/path/to/iam-login-service/env <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  -v /path/to/keystore.jks:/keystore.jks:ro,Z <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  indigoiam/iam-login-service:v1.8.1
$ podman logs -f iam-login-service
</code></pre></div>
</div>
</div>


  
  
  
  

  
  

  



          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://github.com/indigo-iam/iam">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Slack" aria-label="Slack">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://indigo-iam.slack.com">
      <i class="fab fa-slack"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2023 INFN All Rights Reserved</small>
        
	
		
	
      </div>
    </div>
  </div>
</footer>


    </div>
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>













<script src="/v/v1.8.1/js/main.min.63db3e552bd0543be17ce4a79a18b744e9cb72256bec42b540e3ab0cd43722d0.js" integrity="sha256-Y9s&#43;VSvQVDvhfOSnmhi3ROnLciVr7EK1QOOrDNQ3ItA=" crossorigin="anonymous"></script>




  </body>
</html>
